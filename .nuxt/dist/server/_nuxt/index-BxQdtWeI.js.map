{"version":3,"file":"index-BxQdtWeI.js","sources":["../../../../stores/toast.ts","../../../../components/GenerateForm.vue","../../../../stores/activationCodes.ts","../../../../components/CodeList.vue","../../../../components/Toast.vue","../../../../pages/index.vue"],"sourcesContent":["import { defineStore } from 'pinia'\r\n\r\ninterface Toast {\r\n  id: string\r\n  type: 'success' | 'error' | 'warning' | 'info'\r\n  message: string\r\n}\r\n\r\nexport const useToastStore = defineStore('toast', {\r\n  state: () => ({\r\n    toasts: [] as Toast[]\r\n  }),\r\n\r\n  actions: {\r\n    addToast(type: Toast['type'], message: string, duration: number = 5000) {\r\n      const id = Date.now().toString() + Math.random().toString(36).substr(2, 9)\r\n      \r\n      const toast: Toast = {\r\n        id,\r\n        type,\r\n        message\r\n      }\r\n\r\n      this.toasts.push(toast)\r\n\r\n      // 自动移除toast\r\n      setTimeout(() => {\r\n        this.removeToast(id)\r\n      }, duration)\r\n\r\n      return id\r\n    },\r\n\r\n    removeToast(id: string) {\r\n      const index = this.toasts.findIndex(toast => toast.id === id)\r\n      if (index > -1) {\r\n        this.toasts.splice(index, 1)\r\n      }\r\n    },\r\n\r\n    clearAllToasts() {\r\n      this.toasts = []\r\n    }\r\n  }\r\n})\r\n","<template>\r\n  <div class=\"bg-white shadow rounded-lg p-6\">\r\n    <h2 class=\"text-lg font-medium text-gray-900 mb-6\">生成激活码</h2>\r\n    \r\n    <form @submit.prevent=\"generateCodes\" class=\"space-y-6\">\r\n      <div class=\"grid grid-cols-1 gap-6 sm:grid-cols-2\">\r\n        <!-- 生成数量 -->\r\n        <div>\r\n          <label for=\"count\" class=\"block text-sm font-medium text-gray-700\">\r\n            生成数量\r\n          </label>\r\n          <div class=\"mt-1\">\r\n            <input\r\n              id=\"count\"\r\n              v-model.number=\"form.count\"\r\n              type=\"number\"\r\n              min=\"1\"\r\n              max=\"10000\"\r\n              required\r\n              class=\"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md\"\r\n              placeholder=\"请输入生成数量\"\r\n            />\r\n          </div>\r\n          <p class=\"mt-2 text-sm text-gray-500\">单次最多生成10000个激活码</p>\r\n        </div>\r\n\r\n        <!-- 价格 -->\r\n        <div>\r\n          <label for=\"price\" class=\"block text-sm font-medium text-gray-700\">\r\n            单价（元）\r\n          </label>\r\n          <div class=\"mt-1\">\r\n            <input\r\n              id=\"price\"\r\n              v-model.number=\"form.price\"\r\n              type=\"number\"\r\n              min=\"0.01\"\r\n              step=\"0.01\"\r\n              required\r\n              class=\"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md\"\r\n              placeholder=\"请输入单价\"\r\n            />\r\n          </div>\r\n        </div>\r\n\r\n        <!-- 有效期 -->\r\n        <div>\r\n          <label for=\"expirationDays\" class=\"block text-sm font-medium text-gray-700\">\r\n            有效期（天）\r\n          </label>\r\n          <div class=\"mt-1\">\r\n            <input\r\n              id=\"expirationDays\"\r\n              v-model.number=\"form.expirationDays\"\r\n              type=\"number\"\r\n              min=\"1\"\r\n              class=\"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md\"\r\n              placeholder=\"留空表示永不过期\"\r\n            />\r\n          </div>\r\n          <p class=\"mt-2 text-sm text-gray-500\">留空表示永不过期</p>\r\n        </div>\r\n\r\n        <!-- 用户ID（可选） -->\r\n        <div>\r\n          <label for=\"userId\" class=\"block text-sm font-medium text-gray-700\">\r\n            用户ID（可选）\r\n          </label>\r\n          <div class=\"mt-1\">\r\n            <input\r\n              id=\"userId\"\r\n              v-model.number=\"form.userId\"\r\n              type=\"number\"\r\n              min=\"1\"\r\n              class=\"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md\"\r\n              placeholder=\"留空表示不绑定用户\"\r\n            />\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 生成按钮 -->\r\n      <div class=\"flex justify-end\">\r\n        <button\r\n          type=\"submit\"\r\n          :disabled=\"loading\"\r\n          class=\"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed\"\r\n        >\r\n          <svg v-if=\"loading\" class=\"animate-spin -ml-1 mr-3 h-5 w-5 text-white\" xmlns=\"http://www.w3.org/2000/svg\" fill=\"none\" viewBox=\"0 0 24 24\">\r\n            <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n            <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n          </svg>\r\n          {{ loading ? '生成中...' : '生成激活码' }}\r\n        </button>\r\n      </div>\r\n    </form>\r\n\r\n    <!-- 生成结果 -->\r\n    <div v-if=\"generatedCodes.length > 0\" class=\"mt-8\">\r\n      <div class=\"bg-green-50 border border-green-200 rounded-md p-4\">\r\n        <div class=\"flex\">\r\n          <div class=\"flex-shrink-0\">\r\n            <svg class=\"h-5 w-5 text-green-400\" xmlns=\"http://www.w3.org/2000/svg\" viewBox=\"0 0 20 20\" fill=\"currentColor\">\r\n              <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\" />\r\n            </svg>\r\n          </div>\r\n          <div class=\"ml-3\">\r\n            <h3 class=\"text-sm font-medium text-green-800\">\r\n              生成成功！\r\n            </h3>\r\n            <div class=\"mt-2 text-sm text-green-700\">\r\n              <p>成功生成 {{ generatedCodes.length }} 个激活码</p>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 激活码列表 -->\r\n      <div class=\"mt-4\">\r\n        <div class=\"flex justify-between items-center mb-3\">\r\n          <h4 class=\"text-sm font-medium text-gray-900\">生成的激活码</h4>\r\n          <div class=\"space-x-2\">\r\n            <button\r\n              @click=\"copyAllCodes\"\r\n              class=\"inline-flex items-center px-3 py-1 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50\"\r\n            >\r\n              复制全部\r\n            </button>\r\n            <button\r\n              @click=\"exportCodes\"\r\n              class=\"inline-flex items-center px-3 py-1 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50\"\r\n            >\r\n              导出CSV\r\n            </button>\r\n          </div>\r\n        </div>\r\n        \r\n        <div class=\"bg-gray-50 rounded-md p-4 max-h-64 overflow-y-auto\">\r\n          <div class=\"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2\">\r\n            <div\r\n              v-for=\"code in generatedCodes\"\r\n              :key=\"code\"\r\n              class=\"bg-white p-2 rounded border text-sm font-mono cursor-pointer hover:bg-gray-100\"\r\n              @click=\"copyCode(code)\"\r\n              :title=\"'点击复制: ' + code\"\r\n            >\r\n              {{ code }}\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport type { GenerateCodeRequest, GenerateCodeResponse } from '~/types/api'\r\n\r\ninterface FormData {\r\n  count: number\r\n  price: number\r\n  expirationDays: number | null\r\n  userId: number | null\r\n}\r\n\r\nconst form = reactive<FormData>({\r\n  count: 10,\r\n  price: 1.00,\r\n  expirationDays: null,\r\n  userId: null\r\n})\r\n\r\nconst loading = ref(false)\r\nconst generatedCodes = ref<string[]>([])\r\nconst toastStore = useToastStore()\r\n\r\nconst generateCodes = async () => {\r\n  if (form.count <= 0 || form.count > 10000) {\r\n    toastStore.addToast('error', '生成数量必须在1-10000之间')\r\n    return\r\n  }\r\n\r\n  if (form.price <= 0) {\r\n    toastStore.addToast('error', '价格必须大于0')\r\n    return\r\n  }\r\n\r\n  loading.value = true\r\n  \r\n  try {\r\n    // 无认证模式 - 直接调用API\r\n    console.log('无认证模式：正在生成激活码...')\r\n\r\n    const requestData: GenerateCodeRequest = {\r\n      count: form.count,\r\n      price: form.price,\r\n      expirationDays: form.expirationDays || undefined,\r\n      userId: form.userId || undefined\r\n    }\r\n\r\n    const { data } = await $fetch<{ success: boolean; data: GenerateCodeResponse; message: string }>('/api/codes/generate', {\r\n      method: 'POST',\r\n      body: requestData\r\n    })\r\n\r\n    if (data) {\r\n      generatedCodes.value = data.codes\r\n      toastStore.addToast('success', `成功生成${data.totalCount}个激活码`)\r\n      \r\n      // 重置表单\r\n      form.count = 10\r\n      form.price = 1.00\r\n      form.expirationDays = null\r\n      form.userId = null\r\n    }\r\n\r\n  } catch (error: any) {\r\n    console.error('生成激活码失败:', error)\r\n    const message = error.data?.message || '生成激活码失败'\r\n    toastStore.addToast('error', message)\r\n  } finally {\r\n    loading.value = false\r\n  }\r\n}\r\n\r\nconst copyCode = async (code: string) => {\r\n  try {\r\n    await navigator.clipboard.writeText(code)\r\n    toastStore.addToast('success', '激活码已复制到剪贴板')\r\n  } catch (error) {\r\n    console.error('复制失败:', error)\r\n    toastStore.addToast('error', '复制失败')\r\n  }\r\n}\r\n\r\nconst copyAllCodes = async () => {\r\n  try {\r\n    const text = generatedCodes.value.join('\\n')\r\n    await navigator.clipboard.writeText(text)\r\n    toastStore.addToast('success', '所有激活码已复制到剪贴板')\r\n  } catch (error) {\r\n    console.error('复制失败:', error)\r\n    toastStore.addToast('error', '复制失败')\r\n  }\r\n}\r\n\r\nconst exportCodes = () => {\r\n  try {\r\n    const csvContent = 'data:text/csv;charset=utf-8,激活码\\n' + \r\n      generatedCodes.value.join('\\n')\r\n    \r\n    const encodedUri = encodeURI(csvContent)\r\n    const link = document.createElement('a')\r\n    link.setAttribute('href', encodedUri)\r\n    link.setAttribute('download', `激活码_${new Date().toISOString().split('T')[0]}.csv`)\r\n    document.body.appendChild(link)\r\n    link.click()\r\n    document.body.removeChild(link)\r\n    \r\n    toastStore.addToast('success', 'CSV文件已导出')\r\n  } catch (error) {\r\n    console.error('导出失败:', error)\r\n    toastStore.addToast('error', '导出失败')\r\n  }\r\n}\r\n</script>\r\n","import { defineStore } from 'pinia'\r\nimport type { CodeDetailResponse, CodeQueryParams, PaginationResponse } from '~/types/api'\r\nimport { ActivationCodeStatus } from '~/types/database'\r\n\r\nexport const useActivationCodesStore = defineStore('activationCodes', {\r\n  state: () => ({\r\n    codes: [] as CodeDetailResponse[],\r\n    total: 0,\r\n    loading: false,\r\n    currentPage: 1,\r\n    pageSize: 20,\r\n    filters: {\r\n      code: '',\r\n      status: undefined as ActivationCodeStatus | undefined,\r\n      userId: undefined as number | undefined,\r\n      deviceFingerprint: '',\r\n      startDate: '',\r\n      endDate: ''\r\n    } as Omit<CodeQueryParams, 'page' | 'pageSize'>\r\n  }),\r\n\r\n  getters: {\r\n    totalPages: (state) => Math.ceil(state.total / state.pageSize),\r\n    hasFilters: (state) => {\r\n      return !!(\r\n        state.filters.code ||\r\n        state.filters.status ||\r\n        state.filters.userId ||\r\n        state.filters.deviceFingerprint ||\r\n        state.filters.startDate ||\r\n        state.filters.endDate\r\n      )\r\n    }\r\n  },\r\n\r\n  actions: {\r\n    async fetchCodes() {\r\n      this.loading = true\r\n      console.log('Store: fetchCodes 开始执行, process.client:', process.client)\r\n      \r\n      // 如果不是客户端环境，直接返回\r\n      if (!process.client) {\r\n        console.log('Store: 非客户端环境，跳过执行')\r\n        this.loading = false\r\n        return\r\n      }\r\n      \r\n      try {\r\n        // 无认证模式 - 直接调用API\r\n        console.log('Store: 无认证模式，正在获取数据')\r\n\r\n        const params: CodeQueryParams = {\r\n          page: this.currentPage,\r\n          pageSize: this.pageSize,\r\n          ...this.filters\r\n        }\r\n\r\n        // 移除空值\r\n        Object.keys(params).forEach(key => {\r\n          if (params[key as keyof CodeQueryParams] === '' || params[key as keyof CodeQueryParams] === null) {\r\n            delete params[key as keyof CodeQueryParams]\r\n          }\r\n        })\r\n\r\n        const response = await $fetch<{\r\n          success: boolean\r\n          data: PaginationResponse<CodeDetailResponse>\r\n          message: string\r\n        }>('/api/codes/list', {\r\n          method: 'GET',\r\n          query: params\r\n        })\r\n\r\n        if (response.success && response.data) {\r\n          console.log('Store: 接收到数据', {\r\n            items: response.data.items?.length || 0,\r\n            total: response.data.total,\r\n            page: response.data.page\r\n          })\r\n          this.codes = response.data.items\r\n          this.total = response.data.total\r\n          this.currentPage = response.data.page\r\n          console.log('Store: 状态更新后', {\r\n            codesLength: this.codes.length,\r\n            total: this.total,\r\n            currentPage: this.currentPage\r\n          })\r\n        } else {\r\n          console.log('Store: 响应数据异常', response)\r\n        }\r\n\r\n      } catch (error: any) {\r\n        console.error('获取激活码列表失败:', error)\r\n        throw error\r\n      } finally {\r\n        this.loading = false\r\n      }\r\n    },\r\n\r\n    setPage(page: number) {\r\n      this.currentPage = page\r\n    },\r\n\r\n    setPageSize(size: number) {\r\n      this.pageSize = size\r\n      this.currentPage = 1 // 重置到第一页\r\n    },\r\n\r\n    setFilters(filters: Partial<typeof this.filters>) {\r\n      this.filters = { ...this.filters, ...filters }\r\n      this.currentPage = 1 // 重置到第一页\r\n    },\r\n\r\n    clearFilters() {\r\n      this.filters = {\r\n        code: '',\r\n        status: undefined,\r\n        userId: undefined,\r\n        deviceFingerprint: '',\r\n        startDate: '',\r\n        endDate: ''\r\n      }\r\n      this.currentPage = 1\r\n    },\r\n\r\n    async revokeCodes(codes: string[], reason: string) {\r\n      try {\r\n        // 无认证模式 - 直接调用API\r\n        console.log('Store: 无认证模式，正在吊销激活码')\r\n\r\n        const response = await $fetch<{\r\n          success: boolean\r\n          data: any\r\n          message: string\r\n        }>('/api/admin/revoke', {\r\n          method: 'POST',\r\n          body: {\r\n            codes,\r\n            reason\r\n          }\r\n        })\r\n\r\n        if (response.success) {\r\n          // 刷新列表\r\n          await this.fetchCodes()\r\n        }\r\n\r\n        return response\r\n\r\n      } catch (error: any) {\r\n        console.error('吊销激活码失败:', error)\r\n        throw error\r\n      }\r\n    }\r\n  }\r\n})\r\n","<template>\r\n  <div class=\"bg-white shadow rounded-lg\">\r\n    <!-- 搜索和筛选 -->\r\n    <div class=\"p-6 border-b border-gray-200\">\r\n      <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4\">\r\n        <div>\r\n          <label class=\"block text-sm font-medium text-gray-700\">激活码</label>\r\n          <input\r\n            v-model=\"filters.code\"\r\n            type=\"text\"\r\n            class=\"mt-1 form-input\"\r\n            placeholder=\"输入激活码\"\r\n          />\r\n        </div>\r\n        \r\n        <div>\r\n          <label class=\"block text-sm font-medium text-gray-700\">状态</label>\r\n          <select v-model=\"filters.status\" class=\"mt-1 form-select\">\r\n            <option :value=\"undefined\">全部状态</option>\r\n            <option value=\"未使用\">未使用</option>\r\n            <option value=\"已激活\">已激活</option>\r\n            <option value=\"已过期\">已过期</option>\r\n            <option value=\"已吊销\">已吊销</option>\r\n          </select>\r\n        </div>\r\n        \r\n        <div>\r\n          <label class=\"block text-sm font-medium text-gray-700\">用户ID</label>\r\n          <input\r\n            v-model.number=\"filters.userId\"\r\n            type=\"number\"\r\n            class=\"mt-1 form-input\"\r\n            placeholder=\"输入用户ID\"\r\n          />\r\n        </div>\r\n        \r\n        <div class=\"flex items-end space-x-2\">\r\n          <button\r\n            @click=\"search\"\r\n            class=\"btn-primary\"\r\n          >\r\n            搜索\r\n          </button>\r\n          <button\r\n            @click=\"clearFilters\"\r\n            class=\"btn-secondary\"\r\n          >\r\n            清除\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 操作栏 -->\r\n    <div class=\"p-6 border-b border-gray-200\">\r\n      <div class=\"flex justify-between items-center\">\r\n        <div class=\"flex items-center space-x-4\">\r\n          <span class=\"text-sm text-gray-700\">\r\n            已选择 {{ selectedCodes.length }} 项\r\n          </span>\r\n          <button\r\n            v-if=\"selectedCodes.length > 0\"\r\n            @click=\"showRevokeModal = true\"\r\n            class=\"btn-danger\"\r\n          >\r\n            批量吊销\r\n          </button>\r\n        </div>\r\n        \r\n        <div class=\"flex items-center space-x-2\">\r\n          <select v-model=\"pageSize\" @change=\"changePageSize\" class=\"form-select\">\r\n            <option :value=\"10\">每页 10 条</option>\r\n            <option :value=\"20\">每页 20 条</option>\r\n            <option :value=\"50\">每页 50 条</option>\r\n            <option :value=\"100\">每页 100 条</option>\r\n          </select>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 表格 -->\r\n    <div class=\"overflow-x-auto\">\r\n      <table class=\"table-auto\">\r\n        <thead>\r\n          <tr>\r\n            <th class=\"w-4\">\r\n              <input\r\n                type=\"checkbox\"\r\n                :checked=\"allSelected\"\r\n                @change=\"toggleAll\"\r\n                class=\"rounded border-gray-300\"\r\n              />\r\n            </th>\r\n            <th>激活码</th>\r\n            <th>状态</th>\r\n            <th>价格</th>\r\n            <th>用户ID</th>\r\n            <th>设备指纹</th>\r\n            <th>激活时间</th>\r\n            <th>过期时间</th>\r\n            <th>创建时间</th>\r\n            <th>操作</th>\r\n          </tr>\r\n        </thead>\r\n        <tbody class=\"divide-y divide-gray-200\">\r\n          <tr v-if=\"loading\">\r\n            <td colspan=\"10\" class=\"text-center py-8\">\r\n              <div class=\"inline-flex items-center\">\r\n                <svg class=\"animate-spin h-5 w-5 mr-3\" viewBox=\"0 0 24 24\">\r\n                  <circle class=\"opacity-25\" cx=\"12\" cy=\"12\" r=\"10\" stroke=\"currentColor\" stroke-width=\"4\"></circle>\r\n                  <path class=\"opacity-75\" fill=\"currentColor\" d=\"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z\"></path>\r\n                </svg>\r\n                加载中...\r\n              </div>\r\n            </td>\r\n          </tr>\r\n          \r\n          <tr v-else-if=\"codes.length === 0\">\r\n            <td colspan=\"10\" class=\"text-center py-8 text-gray-500\">\r\n              暂无数据\r\n            </td>\r\n          </tr>\r\n          \r\n          <tr v-else v-for=\"code in codes\" :key=\"code.activationCode\" class=\"hover:bg-gray-50\">\r\n            <td>\r\n              <input\r\n                type=\"checkbox\"\r\n                :value=\"code.activationCode\"\r\n                v-model=\"selectedCodes\"\r\n                class=\"rounded border-gray-300\"\r\n              />\r\n            </td>\r\n            <td>\r\n              <span class=\"font-mono text-sm\">{{ code.activationCode }}</span>\r\n            </td>\r\n            <td>\r\n              <span :class=\"getStatusClass(code.status)\">\r\n                {{ code.status }}\r\n              </span>\r\n            </td>\r\n            <td>\r\n              <span class=\"font-medium text-green-600\">\r\n                ¥{{ formatPrice(code.price) }}\r\n              </span>\r\n            </td>\r\n            <td>{{ code.userId || '-' }}</td>\r\n            <td>\r\n              <span v-if=\"code.deviceFingerprint\" class=\"font-mono text-xs truncate max-w-24\">\r\n                {{ code.deviceFingerprint }}\r\n              </span>\r\n              <span v-else>-</span>\r\n            </td>\r\n            <td>{{ formatDate(code.activationDate) }}</td>\r\n            <td>{{ formatDate(code.expirationDate) }}</td>\r\n            <td>{{ formatDate(code.createdTime) }}</td>\r\n            <td>\r\n              <div class=\"flex space-x-2\">\r\n                <button\r\n                  @click=\"copyCode(code.activationCode)\"\r\n                  class=\"text-blue-600 hover:text-blue-800 text-sm\"\r\n                  title=\"复制激活码\"\r\n                >\r\n                  复制\r\n                </button>\r\n                <button\r\n                  v-if=\"code.status !== '已吊销'\"\r\n                  @click=\"revokeCode(code.activationCode)\"\r\n                  class=\"text-red-600 hover:text-red-800 text-sm\"\r\n                >\r\n                  吊销\r\n                </button>\r\n              </div>\r\n            </td>\r\n          </tr>\r\n        </tbody>\r\n      </table>\r\n    </div>\r\n\r\n    <!-- 分页 -->\r\n    <div v-if=\"totalPages > 1\" class=\"p-6 border-t border-gray-200\">\r\n      <div class=\"pagination\">\r\n        <div class=\"pagination-info\">\r\n          显示第 {{ (currentPage - 1) * pageSize + 1 }} - {{ Math.min(currentPage * pageSize, total) }} 条，共 {{ total }} 条\r\n        </div>\r\n        \r\n        <div class=\"pagination-nav\">\r\n          <button\r\n            @click=\"goToPage(currentPage - 1)\"\r\n            :disabled=\"currentPage <= 1\"\r\n            class=\"pagination-nav-item\"\r\n          >\r\n            上一页\r\n          </button>\r\n          \r\n          <button\r\n            v-for=\"page in visiblePages\"\r\n            :key=\"page\"\r\n            @click=\"goToPage(page)\"\r\n            :class=\"['pagination-nav-item', { 'current': page === currentPage }]\"\r\n          >\r\n            {{ page }}\r\n          </button>\r\n          \r\n          <button\r\n            @click=\"goToPage(currentPage + 1)\"\r\n            :disabled=\"currentPage >= totalPages\"\r\n            class=\"pagination-nav-item\"\r\n          >\r\n            下一页\r\n          </button>\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- 吊销确认模态框 -->\r\n    <div v-if=\"showRevokeModal\" class=\"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50\">\r\n      <div class=\"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white\">\r\n        <div class=\"mt-3\">\r\n          <h3 class=\"text-lg font-medium text-gray-900 mb-4\">确认吊销</h3>\r\n          <p class=\"text-sm text-gray-600 mb-4\">\r\n            确定要吊销选中的 {{ selectedCodes.length }} 个激活码吗？此操作不可撤销。\r\n          </p>\r\n          \r\n          <div class=\"mb-4\">\r\n            <label class=\"block text-sm font-medium text-gray-700 mb-2\">吊销原因</label>\r\n            <textarea\r\n              v-model=\"revokeReason\"\r\n              class=\"form-textarea\"\r\n              rows=\"3\"\r\n              placeholder=\"请输入吊销原因\"\r\n              required\r\n            ></textarea>\r\n          </div>\r\n          \r\n          <div class=\"flex justify-end space-x-3\">\r\n            <button\r\n              @click=\"showRevokeModal = false\"\r\n              class=\"btn-secondary\"\r\n            >\r\n              取消\r\n            </button>\r\n            <button\r\n              @click=\"confirmRevoke\"\r\n              :disabled=\"!revokeReason.trim() || revoking\"\r\n              class=\"btn-danger\"\r\n            >\r\n              {{ revoking ? '吊销中...' : '确认吊销' }}\r\n            </button>\r\n          </div>\r\n        </div>\r\n      </div>\r\n    </div>\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\nimport type { CodeDetailResponse } from '~/types/api'\r\nimport { ActivationCodeStatus } from '~/types/database'\r\n\r\nconst activationCodesStore = useActivationCodesStore()\r\nconst toastStore = useToastStore()\r\n\r\n// 响应式数据\r\nconst codes = computed(() => activationCodesStore.codes)\r\nconst loading = computed(() => activationCodesStore.loading)\r\nconst total = computed(() => activationCodesStore.total)\r\nconst currentPage = computed(() => activationCodesStore.currentPage)\r\nconst totalPages = computed(() => activationCodesStore.totalPages)\r\nconst pageSize = ref(activationCodesStore.pageSize)\r\n\r\nconst filters = reactive({\r\n  code: '',\r\n  status: undefined as ActivationCodeStatus | undefined,\r\n  userId: undefined as number | undefined,\r\n  deviceFingerprint: '',\r\n  startDate: '',\r\n  endDate: ''\r\n})\r\n\r\nconst selectedCodes = ref<string[]>([])\r\nconst showRevokeModal = ref(false)\r\nconst revokeReason = ref('')\r\nconst revoking = ref(false)\r\n\r\n// 计算属性\r\nconst allSelected = computed(() => {\r\n  return codes.value.length > 0 && selectedCodes.value.length === codes.value.length\r\n})\r\n\r\nconst visiblePages = computed(() => {\r\n  const pages: number[] = []\r\n  const start = Math.max(1, currentPage.value - 2)\r\n  const end = Math.min(totalPages.value, currentPage.value + 2)\r\n  \r\n  for (let i = start; i <= end; i++) {\r\n    pages.push(i)\r\n  }\r\n  \r\n  return pages\r\n})\r\n\r\n// 方法\r\nconst search = async () => {\r\n  console.log('开始搜索，筛选条件:', filters)\r\n  try {\r\n    activationCodesStore.setFilters(filters)\r\n    await activationCodesStore.fetchCodes()\r\n    console.log('搜索完成，结果数量:', codes.value.length)\r\n  } catch (error) {\r\n    console.error('搜索失败:', error)\r\n    toastStore.addToast('error', '搜索失败: ' + (error as Error).message)\r\n  }\r\n}\r\n\r\nconst clearFilters = async () => {\r\n  Object.assign(filters, {\r\n    code: '',\r\n    status: undefined,\r\n    userId: undefined,\r\n    deviceFingerprint: '',\r\n    startDate: '',\r\n    endDate: ''\r\n  })\r\n  activationCodesStore.clearFilters()\r\n  await activationCodesStore.fetchCodes()\r\n}\r\n\r\nconst changePageSize = async () => {\r\n  activationCodesStore.setPageSize(pageSize.value)\r\n  await activationCodesStore.fetchCodes()\r\n}\r\n\r\nconst goToPage = async (page: number) => {\r\n  if (page >= 1 && page <= totalPages.value) {\r\n    activationCodesStore.setPage(page)\r\n    await activationCodesStore.fetchCodes()\r\n  }\r\n}\r\n\r\nconst toggleAll = () => {\r\n  if (allSelected.value) {\r\n    selectedCodes.value = []\r\n  } else {\r\n    selectedCodes.value = codes.value.map(code => code.activationCode)\r\n  }\r\n}\r\n\r\nconst copyCode = async (code: string) => {\r\n  try {\r\n    await navigator.clipboard.writeText(code)\r\n    toastStore.addToast('success', '激活码已复制到剪贴板')\r\n  } catch (error) {\r\n    toastStore.addToast('error', '复制失败')\r\n  }\r\n}\r\n\r\nconst revokeCode = (code: string) => {\r\n  selectedCodes.value = [code]\r\n  showRevokeModal.value = true\r\n}\r\n\r\nconst confirmRevoke = async () => {\r\n  if (!revokeReason.value.trim()) {\r\n    toastStore.addToast('error', '请输入吊销原因')\r\n    return\r\n  }\r\n\r\n  revoking.value = true\r\n\r\n  try {\r\n    const response = await activationCodesStore.revokeCodes(selectedCodes.value, revokeReason.value)\r\n    \r\n    if (response.success) {\r\n      toastStore.addToast('success', response.message || '吊销成功')\r\n      selectedCodes.value = []\r\n      showRevokeModal.value = false\r\n      revokeReason.value = ''\r\n    } else {\r\n      toastStore.addToast('error', response.message || '吊销失败')\r\n    }\r\n  } catch (error: any) {\r\n    console.error('吊销失败:', error)\r\n    toastStore.addToast('error', error.data?.message || '吊销失败')\r\n  } finally {\r\n    revoking.value = false\r\n  }\r\n}\r\n\r\nconst getStatusClass = (status: string) => {\r\n  const baseClass = 'status-badge'\r\n  switch (status) {\r\n    case '未使用':\r\n      return `${baseClass} unused`\r\n    case '已激活':\r\n      return `${baseClass} activated`\r\n    case '已过期':\r\n      return `${baseClass} expired`\r\n    case '已吊销':\r\n      return `${baseClass} revoked`\r\n    default:\r\n      return baseClass\r\n  }\r\n}\r\n\r\nconst formatDate = (date: Date | string | null) => {\r\n  if (!date) return '-'\r\n  return new Date(date).toLocaleString('zh-CN')\r\n}\r\n\r\nconst formatPrice = (price: any) => {\r\n  if (price === null || price === undefined) return '0.00'\r\n  const numPrice = typeof price === 'string' ? parseFloat(price) : price\r\n  if (isNaN(numPrice)) return '0.00'\r\n  return numPrice.toFixed(2)\r\n}\r\n\r\n// 页面加载时获取数据\r\nonMounted(async () => {\r\n  console.log('CodeList mounted, 开始获取数据')\r\n  \r\n  // 确保在客户端执行\r\n  if (!process.client) {\r\n    console.log('CodeList: 非客户端环境，跳过数据获取')\r\n    return\r\n  }\r\n  \r\n  // 等待一个tick确保DOM完全加载\r\n  await nextTick()\r\n  \r\n  // 额外等待确保localStorage可用\r\n  setTimeout(async () => {\r\n    try {\r\n      await activationCodesStore.fetchCodes()\r\n      console.log('CodeList mounted, 数据获取完成:', {\r\n        loading: loading.value,\r\n        codesLength: codes.value.length,\r\n        total: total.value\r\n      })\r\n    } catch (error) {\r\n      console.error('CodeList mounted, 数据获取失败:', error)\r\n      toastStore.addToast('error', '数据加载失败: ' + (error as Error).message)\r\n    }\r\n  }, 100)\r\n})\r\n</script>\r\n","<template>\r\n  <transition-group \r\n    name=\"toast\" \r\n    tag=\"div\" \r\n    class=\"fixed top-4 right-4 z-50 space-y-2\"\r\n  >\r\n    <div\r\n      v-for=\"toast in toasts\"\r\n      :key=\"toast.id\"\r\n      :class=\"[\r\n        'px-6 py-4 rounded-lg shadow-lg text-white font-medium max-w-sm',\r\n        {\r\n          'bg-green-500': toast.type === 'success',\r\n          'bg-red-500': toast.type === 'error',\r\n          'bg-yellow-500': toast.type === 'warning',\r\n          'bg-blue-500': toast.type === 'info'\r\n        }\r\n      ]\"\r\n    >\r\n      <div class=\"flex items-center justify-between\">\r\n        <div class=\"flex items-center space-x-2\">\r\n          <svg \r\n            v-if=\"toast.type === 'success'\" \r\n            class=\"w-5 h-5\" \r\n            fill=\"currentColor\" \r\n            viewBox=\"0 0 20 20\"\r\n          >\r\n            <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z\" clip-rule=\"evenodd\" />\r\n          </svg>\r\n          <svg \r\n            v-else-if=\"toast.type === 'error'\" \r\n            class=\"w-5 h-5\" \r\n            fill=\"currentColor\" \r\n            viewBox=\"0 0 20 20\"\r\n          >\r\n            <path fill-rule=\"evenodd\" d=\"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z\" clip-rule=\"evenodd\" />\r\n          </svg>\r\n          <svg \r\n            v-else-if=\"toast.type === 'warning'\" \r\n            class=\"w-5 h-5\" \r\n            fill=\"currentColor\" \r\n            viewBox=\"0 0 20 20\"\r\n          >\r\n            <path fill-rule=\"evenodd\" d=\"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z\" clip-rule=\"evenodd\" />\r\n          </svg>\r\n          <svg \r\n            v-else \r\n            class=\"w-5 h-5\" \r\n            fill=\"currentColor\" \r\n            viewBox=\"0 0 20 20\"\r\n          >\r\n            <path fill-rule=\"evenodd\" d=\"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z\" clip-rule=\"evenodd\" />\r\n          </svg>\r\n          <span>{{ toast.message }}</span>\r\n        </div>\r\n        <button\r\n          @click=\"removeToast(toast.id)\"\r\n          class=\"ml-4 text-white hover:text-gray-200 focus:outline-none\"\r\n        >\r\n          <svg class=\"w-4 h-4\" fill=\"currentColor\" viewBox=\"0 0 20 20\">\r\n            <path fill-rule=\"evenodd\" d=\"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z\" clip-rule=\"evenodd\" />\r\n          </svg>\r\n        </button>\r\n      </div>\r\n    </div>\r\n  </transition-group>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\ninterface Toast {\r\n  id: string\r\n  type: 'success' | 'error' | 'warning' | 'info'\r\n  message: string\r\n}\r\n\r\nconst toastStore = useToastStore()\r\nconst toasts = computed(() => toastStore.toasts)\r\n\r\nconst removeToast = (id: string) => {\r\n  toastStore.removeToast(id)\r\n}\r\n</script>\r\n\r\n<style scoped>\r\n.toast-enter-active,\r\n.toast-leave-active {\r\n  transition: all 0.3s ease;\r\n}\r\n\r\n.toast-enter-from {\r\n  opacity: 0;\r\n  transform: translateX(100%);\r\n}\r\n\r\n.toast-leave-to {\r\n  opacity: 0;\r\n  transform: translateX(100%);\r\n}\r\n\r\n.toast-move {\r\n  transition: transform 0.3s ease;\r\n}\r\n</style>\r\n","<template>\r\n  <div class=\"min-h-screen bg-gray-50 py-8\">\r\n    <div class=\"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8\">\r\n      <!-- 页面头部 -->\r\n      <div class=\"mb-8\">\r\n        <h1 class=\"text-3xl font-bold text-gray-900\">激活码管理系统</h1>\r\n        <p class=\"mt-2 text-sm text-gray-600\">游戏脚本激活码管理平台 - 无需登录模式</p>\r\n      </div>\r\n\r\n      <!-- 统计卡片 -->\r\n      <div class=\"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8\">\r\n        <div class=\"bg-white overflow-hidden shadow rounded-lg\">\r\n          <div class=\"p-5\">\r\n            <div class=\"flex items-center\">\r\n              <div class=\"flex-shrink-0\">\r\n                <div class=\"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center\">\r\n                  <svg class=\"w-5 h-5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z\"></path>\r\n                  </svg>\r\n                </div>\r\n              </div>\r\n              <div class=\"ml-5 w-0 flex-1\">\r\n                <dl>\r\n                  <dt class=\"text-sm font-medium text-gray-500 truncate\">总激活码</dt>\r\n                  <dd class=\"text-lg font-medium text-gray-900\">{{ total || 0 }}</dd>\r\n                </dl>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"bg-white overflow-hidden shadow rounded-lg\">\r\n          <div class=\"p-5\">\r\n            <div class=\"flex items-center\">\r\n              <div class=\"flex-shrink-0\">\r\n                <div class=\"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center\">\r\n                  <svg class=\"w-5 h-5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z\"></path>\r\n                  </svg>\r\n                </div>\r\n              </div>\r\n              <div class=\"ml-5 w-0 flex-1\">\r\n                <dl>\r\n                  <dt class=\"text-sm font-medium text-gray-500 truncate\">已激活</dt>\r\n                  <dd class=\"text-lg font-medium text-gray-900\">{{ activatedCount || 0 }}</dd>\r\n                </dl>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"bg-white overflow-hidden shadow rounded-lg\">\r\n          <div class=\"p-5\">\r\n            <div class=\"flex items-center\">\r\n              <div class=\"flex-shrink-0\">\r\n                <div class=\"w-8 h-8 bg-yellow-500 rounded-md flex items-center justify-center\">\r\n                  <svg class=\"w-5 h-5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z\"></path>\r\n                  </svg>\r\n                </div>\r\n              </div>\r\n              <div class=\"ml-5 w-0 flex-1\">\r\n                <dl>\r\n                  <dt class=\"text-sm font-medium text-gray-500 truncate\">未使用</dt>\r\n                  <dd class=\"text-lg font-medium text-gray-900\">{{ unusedCount || 0 }}</dd>\r\n                </dl>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n\r\n        <div class=\"bg-white overflow-hidden shadow rounded-lg\">\r\n          <div class=\"p-5\">\r\n            <div class=\"flex items-center\">\r\n              <div class=\"flex-shrink-0\">\r\n                <div class=\"w-8 h-8 bg-red-500 rounded-md flex items-center justify-center\">\r\n                  <svg class=\"w-5 h-5 text-white\" fill=\"none\" stroke=\"currentColor\" viewBox=\"0 0 24 24\">\r\n                    <path stroke-linecap=\"round\" stroke-linejoin=\"round\" stroke-width=\"2\" d=\"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728\"></path>\r\n                  </svg>\r\n                </div>\r\n              </div>\r\n              <div class=\"ml-5 w-0 flex-1\">\r\n                <dl>\r\n                  <dt class=\"text-sm font-medium text-gray-500 truncate\">已过期/吊销</dt>\r\n                  <dd class=\"text-lg font-medium text-gray-900\">{{ expiredRevokedCount || 0 }}</dd>\r\n                </dl>\r\n              </div>\r\n            </div>\r\n          </div>\r\n        </div>\r\n      </div>\r\n\r\n      <!-- 功能区 -->\r\n      <div class=\"grid grid-cols-1 lg:grid-cols-3 gap-8\">\r\n        <!-- 生成激活码表单 -->\r\n        <div class=\"lg:col-span-1\">\r\n          <GenerateForm />\r\n        </div>\r\n\r\n        <!-- 激活码列表 -->\r\n        <div class=\"lg:col-span-2\">\r\n          <CodeList />\r\n        </div>\r\n      </div>\r\n    </div>\r\n\r\n    <!-- Toast组件 -->\r\n    <Toast />\r\n  </div>\r\n</template>\r\n\r\n<script setup lang=\"ts\">\r\n// 页面元信息\r\ndefinePageMeta({\r\n  layout: false\r\n})\r\n\r\n// 使用store\r\nconst activationCodesStore = useActivationCodesStore()\r\n\r\n// 统计数据状态\r\nconst stats = ref({\r\n  totalCodes: 0,\r\n  activatedCodes: 0,\r\n  unusedCodes: 0,\r\n  expiredRevokedCodes: 0\r\n})\r\n\r\n// 计算属性 - 从统计API获取的数据\r\nconst total = computed(() => stats.value.totalCodes)\r\nconst activatedCount = computed(() => stats.value.activatedCodes)\r\nconst unusedCount = computed(() => stats.value.unusedCodes)\r\nconst expiredRevokedCount = computed(() => stats.value.expiredRevokedCodes)\r\n\r\n// 获取统计数据的函数\r\nconst fetchStats = async () => {\r\n  try {\r\n    console.log('开始获取统计数据')\r\n    const response = await $fetch<{\r\n      success: boolean\r\n      data: {\r\n        totalCodes: number\r\n        activatedCodes: number\r\n        expiredCodes: number\r\n        revokedCodes: number\r\n      }\r\n      message: string\r\n    }>('/api/admin/stats')\r\n\r\n    if (response.success && response.data) {\r\n      stats.value = {\r\n        totalCodes: response.data.totalCodes,\r\n        activatedCodes: response.data.activatedCodes,\r\n        unusedCodes: response.data.totalCodes - response.data.activatedCodes - response.data.expiredCodes - response.data.revokedCodes,\r\n        expiredRevokedCodes: response.data.expiredCodes + response.data.revokedCodes\r\n      }\r\n      console.log('统计数据获取成功:', stats.value)\r\n    }\r\n  } catch (error) {\r\n    console.error('获取统计数据失败:', error)\r\n    // 如果统计API失败，回退到store中的数据\r\n    const codes = activationCodesStore.codes\r\n    stats.value = {\r\n      totalCodes: activationCodesStore.total,\r\n      activatedCodes: codes.filter(code => code.status === '已激活').length,\r\n      unusedCodes: codes.filter(code => code.status === '未使用').length,\r\n      expiredRevokedCodes: codes.filter(code => code.status === '已过期' || code.status === '已吊销').length\r\n    }\r\n  }\r\n}\r\n\r\n// 页面加载时获取数据\r\nonMounted(async () => {\r\n  console.log('Index page mounted, 开始获取数据')\r\n  \r\n  // 确保在客户端执行\r\n  if (!process.client) {\r\n    console.log('Index page: 非客户端环境，跳过数据获取')\r\n    return\r\n  }\r\n  \r\n  // 等待一个tick确保DOM完全加载\r\n  await nextTick()\r\n  \r\n  // 并行获取统计数据和激活码列表\r\n  try {\r\n    await Promise.all([\r\n      fetchStats(),\r\n      activationCodesStore.fetchCodes()\r\n    ])\r\n    console.log('Index page mounted, 数据获取完成')\r\n  } catch (error) {\r\n    console.error('Index page mounted, 数据获取失败:', error)\r\n  }\r\n})\r\n</script>\r\n"],"names":["_ssrRenderAttrs","_mergeProps","_ssrRenderAttr","_unref","_ssrInterpolate","_ssrRenderList","_ssrIncludeBooleanAttr","_ssrLooseContain","_ssrLooseEqual","_ssrRenderClass"],"mappings":"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"}