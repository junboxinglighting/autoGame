import{F as R,d as I,G as A,r as k,y as m,z as u,A as t,H as T,I as et,J as w,K as $,L as l,E as N,B as p,M as z,N as D,k as b,o as H,O,P as U,Q as L,R as st,S as F,T as ot,D as lt,U as nt,_ as at,C as V}from"./CMbB7OXZ.js";const j=R("toast",{state:()=>({toasts:[]}),actions:{addToast(i,o,a=5e3){const f=Date.now().toString()+Math.random().toString(36).substr(2,9),x={id:f,type:i,message:o};return this.toasts.push(x),setTimeout(()=>{this.removeToast(f)},a),f},removeToast(i){const o=this.toasts.findIndex(a=>a.id===i);o>-1&&this.toasts.splice(o,1)},clearAllToasts(){this.toasts=[]}}}),rt={class:"bg-white shadow rounded-lg p-6"},dt={class:"grid grid-cols-1 gap-6 sm:grid-cols-2"},it={class:"mt-1"},ct={class:"mt-1"},ut={class:"mt-1"},mt={class:"mt-1"},vt={class:"flex justify-end"},gt=["disabled"],pt={key:0,class:"animate-spin -ml-1 mr-3 h-5 w-5 text-white",xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24"},ft={key:0,class:"mt-8"},xt={class:"bg-green-50 border border-green-200 rounded-md p-4"},ht={class:"flex"},bt={class:"ml-3"},yt={class:"mt-2 text-sm text-green-700"},wt={class:"mt-4"},Ct={class:"bg-gray-50 rounded-md p-4 max-h-64 overflow-y-auto"},_t={class:"grid grid-cols-1 sm:grid-cols-2 lg:grid-cols-3 gap-2"},kt=["onClick","title"],$t=I({__name:"GenerateForm",setup(i){const o=A({count:10,price:1,expirationDays:null,userId:null}),a=k(!1),f=k([]),x=j(),h=async()=>{if(o.count<=0||o.count>1e4){x.addToast("error","生成数量必须在1-10000之间");return}if(o.price<=0){x.addToast("error","价格必须大于0");return}a.value=!0;try{console.log("无认证模式：正在生成激活码...");const n={count:o.count,price:o.price,expirationDays:o.expirationDays||void 0,userId:o.userId||void 0},{data:s}=await $fetch("/api/codes/generate",{method:"POST",body:n});s&&(f.value=s.codes,x.addToast("success",`成功生成${s.totalCount}个激活码`),o.count=10,o.price=1,o.expirationDays=null,o.userId=null)}catch(n){console.error("生成激活码失败:",n);const s=n.data?.message||"生成激活码失败";x.addToast("error",s)}finally{a.value=!1}},v=async n=>{try{await navigator.clipboard.writeText(n),x.addToast("success","激活码已复制到剪贴板")}catch(s){console.error("复制失败:",s),x.addToast("error","复制失败")}},C=async()=>{try{const n=f.value.join(`
`);await navigator.clipboard.writeText(n),x.addToast("success","所有激活码已复制到剪贴板")}catch(n){console.error("复制失败:",n),x.addToast("error","复制失败")}},g=()=>{try{const n=`data:text/csv;charset=utf-8,激活码
`+f.value.join(`
`),s=encodeURI(n),c=document.createElement("a");c.setAttribute("href",s),c.setAttribute("download",`激活码_${new Date().toISOString().split("T")[0]}.csv`),document.body.appendChild(c),c.click(),document.body.removeChild(c),x.addToast("success","CSV文件已导出")}catch(n){console.error("导出失败:",n),x.addToast("error","导出失败")}};return(n,s)=>(u(),m("div",rt,[s[14]||(s[14]=t("h2",{class:"text-lg font-medium text-gray-900 mb-6"},"生成激活码",-1)),t("form",{onSubmit:et(h,["prevent"]),class:"space-y-6"},[t("div",dt,[t("div",null,[s[4]||(s[4]=t("label",{for:"count",class:"block text-sm font-medium text-gray-700"}," 生成数量 ",-1)),t("div",it,[w(t("input",{id:"count","onUpdate:modelValue":s[0]||(s[0]=c=>l(o).count=c),type:"number",min:"1",max:"10000",required:"",class:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"请输入生成数量"},null,512),[[$,l(o).count,void 0,{number:!0}]])]),s[5]||(s[5]=t("p",{class:"mt-2 text-sm text-gray-500"},"单次最多生成10000个激活码",-1))]),t("div",null,[s[6]||(s[6]=t("label",{for:"price",class:"block text-sm font-medium text-gray-700"}," 单价（元） ",-1)),t("div",ct,[w(t("input",{id:"price","onUpdate:modelValue":s[1]||(s[1]=c=>l(o).price=c),type:"number",min:"0.01",step:"0.01",required:"",class:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"请输入单价"},null,512),[[$,l(o).price,void 0,{number:!0}]])])]),t("div",null,[s[7]||(s[7]=t("label",{for:"expirationDays",class:"block text-sm font-medium text-gray-700"}," 有效期（天） ",-1)),t("div",ut,[w(t("input",{id:"expirationDays","onUpdate:modelValue":s[2]||(s[2]=c=>l(o).expirationDays=c),type:"number",min:"1",class:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"留空表示永不过期"},null,512),[[$,l(o).expirationDays,void 0,{number:!0}]])]),s[8]||(s[8]=t("p",{class:"mt-2 text-sm text-gray-500"},"留空表示永不过期",-1))]),t("div",null,[s[9]||(s[9]=t("label",{for:"userId",class:"block text-sm font-medium text-gray-700"}," 用户ID（可选） ",-1)),t("div",mt,[w(t("input",{id:"userId","onUpdate:modelValue":s[3]||(s[3]=c=>l(o).userId=c),type:"number",min:"1",class:"shadow-sm focus:ring-blue-500 focus:border-blue-500 block w-full sm:text-sm border-gray-300 rounded-md",placeholder:"留空表示不绑定用户"},null,512),[[$,l(o).userId,void 0,{number:!0}]])])])]),t("div",vt,[t("button",{type:"submit",disabled:l(a),class:"inline-flex justify-center py-2 px-4 border border-transparent shadow-sm text-sm font-medium rounded-md text-white bg-blue-600 hover:bg-blue-700 focus:outline-none focus:ring-2 focus:ring-offset-2 focus:ring-blue-500 disabled:opacity-50 disabled:cursor-not-allowed"},[l(a)?(u(),m("svg",pt,s[10]||(s[10]=[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"},null,-1),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"},null,-1)]))):T("",!0),N(" "+p(l(a)?"生成中...":"生成激活码"),1)],8,gt)])],32),l(f).length>0?(u(),m("div",ft,[t("div",xt,[t("div",ht,[s[12]||(s[12]=t("div",{class:"flex-shrink-0"},[t("svg",{class:"h-5 w-5 text-green-400",xmlns:"http://www.w3.org/2000/svg",viewBox:"0 0 20 20",fill:"currentColor"},[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"})])],-1)),t("div",bt,[s[11]||(s[11]=t("h3",{class:"text-sm font-medium text-green-800"}," 生成成功！ ",-1)),t("div",yt,[t("p",null,"成功生成 "+p(l(f).length)+" 个激活码",1)])])])]),t("div",wt,[t("div",{class:"flex justify-between items-center mb-3"},[s[13]||(s[13]=t("h4",{class:"text-sm font-medium text-gray-900"},"生成的激活码",-1)),t("div",{class:"space-x-2"},[t("button",{onClick:C,class:"inline-flex items-center px-3 py-1 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50"}," 复制全部 "),t("button",{onClick:g,class:"inline-flex items-center px-3 py-1 border border-gray-300 shadow-sm text-xs font-medium rounded text-gray-700 bg-white hover:bg-gray-50"}," 导出CSV ")])]),t("div",Ct,[t("div",_t,[(u(!0),m(z,null,D(l(f),c=>(u(),m("div",{key:c,class:"bg-white p-2 rounded border text-sm font-mono cursor-pointer hover:bg-gray-100",onClick:y=>v(c),title:"点击复制: "+c},p(c),9,kt))),128))])])])])):T("",!0)]))}}),q=R("activationCodes",{state:()=>({codes:[],total:0,loading:!1,currentPage:1,pageSize:20,filters:{code:"",status:void 0,userId:void 0,deviceFingerprint:"",startDate:"",endDate:""}}),getters:{totalPages:i=>Math.ceil(i.total/i.pageSize),hasFilters:i=>!!(i.filters.code||i.filters.status||i.filters.userId||i.filters.deviceFingerprint||i.filters.startDate||i.filters.endDate)},actions:{async fetchCodes(){this.loading=!0,console.log("Store: fetchCodes 开始执行, process.client:",!0);try{console.log("Store: 无认证模式，正在获取数据");const i={page:this.currentPage,pageSize:this.pageSize,...this.filters};Object.keys(i).forEach(a=>{(i[a]===""||i[a]===null)&&delete i[a]});const o=await $fetch("/api/codes/list",{method:"GET",query:i});o.success&&o.data?(console.log("Store: 接收到数据",{items:o.data.items?.length||0,total:o.data.total,page:o.data.page}),this.codes=o.data.items,this.total=o.data.total,this.currentPage=o.data.page,console.log("Store: 状态更新后",{codesLength:this.codes.length,total:this.total,currentPage:this.currentPage})):console.log("Store: 响应数据异常",o)}catch(i){throw console.error("获取激活码列表失败:",i),i}finally{this.loading=!1}},setPage(i){this.currentPage=i},setPageSize(i){this.pageSize=i,this.currentPage=1},setFilters(i){this.filters={...this.filters,...i},this.currentPage=1},clearFilters(){this.filters={code:"",status:void 0,userId:void 0,deviceFingerprint:"",startDate:"",endDate:""},this.currentPage=1},async revokeCodes(i,o){try{console.log("Store: 无认证模式，正在吊销激活码");const a=await $fetch("/api/admin/revoke",{method:"POST",body:{codes:i,reason:o}});return a.success&&await this.fetchCodes(),a}catch(a){throw console.error("吊销激活码失败:",a),a}}}}),Tt={class:"bg-white shadow rounded-lg"},St={class:"p-6 border-b border-gray-200"},zt={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-4"},Dt={class:"p-6 border-b border-gray-200"},It={class:"flex justify-between items-center"},Mt={class:"flex items-center space-x-4"},Pt={class:"text-sm text-gray-700"},Lt={class:"flex items-center space-x-2"},Vt={class:"overflow-x-auto"},Ft={class:"table-auto"},jt={class:"w-4"},Bt=["checked"],Ut={class:"divide-y divide-gray-200"},Rt={key:0},At={key:1},Nt=["value"],Ht={class:"font-mono text-sm"},Ot={class:"font-medium text-green-600"},qt={key:0,class:"font-mono text-xs truncate max-w-24"},Et={key:1},Gt={class:"flex space-x-2"},Jt=["onClick"],Kt=["onClick"],Qt={key:0,class:"p-6 border-t border-gray-200"},Wt={class:"pagination"},Xt={class:"pagination-info"},Yt={class:"pagination-nav"},Zt=["disabled"],te=["onClick"],ee=["disabled"],se={key:1,class:"fixed inset-0 bg-gray-600 bg-opacity-50 overflow-y-auto h-full w-full z-50"},oe={class:"relative top-20 mx-auto p-5 border w-96 shadow-lg rounded-md bg-white"},le={class:"mt-3"},ne={class:"text-sm text-gray-600 mb-4"},ae={class:"mb-4"},re={class:"flex justify-end space-x-3"},de=["disabled"],ie=I({__name:"CodeList",setup(i){const o=q(),a=j(),f=b(()=>o.codes),x=b(()=>o.loading),h=b(()=>o.total),v=b(()=>o.currentPage),C=b(()=>o.totalPages),g=k(o.pageSize),n=A({code:"",status:void 0,userId:void 0,deviceFingerprint:"",startDate:"",endDate:""}),s=k([]),c=k(!1),y=k(""),S=k(!1),B=b(()=>f.value.length>0&&s.value.length===f.value.length),E=b(()=>{const r=[],e=Math.max(1,v.value-2),d=Math.min(C.value,v.value+2);for(let _=e;_<=d;_++)r.push(_);return r}),G=async()=>{console.log("开始搜索，筛选条件:",n);try{o.setFilters(n),await o.fetchCodes(),console.log("搜索完成，结果数量:",f.value.length)}catch(r){console.error("搜索失败:",r),a.addToast("error","搜索失败: "+r.message)}},J=async()=>{Object.assign(n,{code:"",status:void 0,userId:void 0,deviceFingerprint:"",startDate:"",endDate:""}),o.clearFilters(),await o.fetchCodes()},K=async()=>{o.setPageSize(g.value),await o.fetchCodes()},M=async r=>{r>=1&&r<=C.value&&(o.setPage(r),await o.fetchCodes())},Q=()=>{B.value?s.value=[]:s.value=f.value.map(r=>r.activationCode)},W=async r=>{try{await navigator.clipboard.writeText(r),a.addToast("success","激活码已复制到剪贴板")}catch{a.addToast("error","复制失败")}},X=r=>{s.value=[r],c.value=!0},Y=async()=>{if(!y.value.trim()){a.addToast("error","请输入吊销原因");return}S.value=!0;try{const r=await o.revokeCodes(s.value,y.value);r.success?(a.addToast("success",r.message||"吊销成功"),s.value=[],c.value=!1,y.value=""):a.addToast("error",r.message||"吊销失败")}catch(r){console.error("吊销失败:",r),a.addToast("error",r.data?.message||"吊销失败")}finally{S.value=!1}},Z=r=>{const e="status-badge";switch(r){case"未使用":return`${e} unused`;case"已激活":return`${e} activated`;case"已过期":return`${e} expired`;case"已吊销":return`${e} revoked`;default:return e}},P=r=>r?new Date(r).toLocaleString("zh-CN"):"-",tt=r=>{if(r==null)return"0.00";const e=typeof r=="string"?parseFloat(r):r;return isNaN(e)?"0.00":e.toFixed(2)};return H(async()=>{console.log("CodeList mounted, 开始获取数据"),await O(),setTimeout(async()=>{try{await o.fetchCodes(),console.log("CodeList mounted, 数据获取完成:",{loading:x.value,codesLength:f.value.length,total:h.value})}catch(r){console.error("CodeList mounted, 数据获取失败:",r),a.addToast("error","数据加载失败: "+r.message)}},100)}),(r,e)=>(u(),m("div",Tt,[t("div",St,[t("div",zt,[t("div",null,[e[10]||(e[10]=t("label",{class:"block text-sm font-medium text-gray-700"},"激活码",-1)),w(t("input",{"onUpdate:modelValue":e[0]||(e[0]=d=>l(n).code=d),type:"text",class:"mt-1 form-input",placeholder:"输入激活码"},null,512),[[$,l(n).code]])]),t("div",null,[e[12]||(e[12]=t("label",{class:"block text-sm font-medium text-gray-700"},"状态",-1)),w(t("select",{"onUpdate:modelValue":e[1]||(e[1]=d=>l(n).status=d),class:"mt-1 form-select"},e[11]||(e[11]=[t("option",{value:void 0},"全部状态",-1),t("option",{value:"未使用"},"未使用",-1),t("option",{value:"已激活"},"已激活",-1),t("option",{value:"已过期"},"已过期",-1),t("option",{value:"已吊销"},"已吊销",-1)]),512),[[U,l(n).status]])]),t("div",null,[e[13]||(e[13]=t("label",{class:"block text-sm font-medium text-gray-700"},"用户ID",-1)),w(t("input",{"onUpdate:modelValue":e[2]||(e[2]=d=>l(n).userId=d),type:"number",class:"mt-1 form-input",placeholder:"输入用户ID"},null,512),[[$,l(n).userId,void 0,{number:!0}]])]),t("div",{class:"flex items-end space-x-2"},[t("button",{onClick:G,class:"btn-primary"}," 搜索 "),t("button",{onClick:J,class:"btn-secondary"}," 清除 ")])])]),t("div",Dt,[t("div",It,[t("div",Mt,[t("span",Pt," 已选择 "+p(l(s).length)+" 项 ",1),l(s).length>0?(u(),m("button",{key:0,onClick:e[3]||(e[3]=d=>c.value=!0),class:"btn-danger"}," 批量吊销 ")):T("",!0)]),t("div",Lt,[w(t("select",{"onUpdate:modelValue":e[4]||(e[4]=d=>L(g)?g.value=d:null),onChange:K,class:"form-select"},e[14]||(e[14]=[t("option",{value:10},"每页 10 条",-1),t("option",{value:20},"每页 20 条",-1),t("option",{value:50},"每页 50 条",-1),t("option",{value:100},"每页 100 条",-1)]),544),[[U,l(g)]])])])]),t("div",Vt,[t("table",Ft,[t("thead",null,[t("tr",null,[t("th",jt,[t("input",{type:"checkbox",checked:l(B),onChange:Q,class:"rounded border-gray-300"},null,40,Bt)]),e[15]||(e[15]=t("th",null,"激活码",-1)),e[16]||(e[16]=t("th",null,"状态",-1)),e[17]||(e[17]=t("th",null,"价格",-1)),e[18]||(e[18]=t("th",null,"用户ID",-1)),e[19]||(e[19]=t("th",null,"设备指纹",-1)),e[20]||(e[20]=t("th",null,"激活时间",-1)),e[21]||(e[21]=t("th",null,"过期时间",-1)),e[22]||(e[22]=t("th",null,"创建时间",-1)),e[23]||(e[23]=t("th",null,"操作",-1))])]),t("tbody",Ut,[l(x)?(u(),m("tr",Rt,e[24]||(e[24]=[t("td",{colspan:"10",class:"text-center py-8"},[t("div",{class:"inline-flex items-center"},[t("svg",{class:"animate-spin h-5 w-5 mr-3",viewBox:"0 0 24 24"},[t("circle",{class:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor","stroke-width":"4"}),t("path",{class:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z"})]),N(" 加载中... ")])],-1)]))):l(f).length===0?(u(),m("tr",At,e[25]||(e[25]=[t("td",{colspan:"10",class:"text-center py-8 text-gray-500"}," 暂无数据 ",-1)]))):(u(!0),m(z,{key:2},D(l(f),d=>(u(),m("tr",{key:d.activationCode,class:"hover:bg-gray-50"},[t("td",null,[w(t("input",{type:"checkbox",value:d.activationCode,"onUpdate:modelValue":e[5]||(e[5]=_=>L(s)?s.value=_:null),class:"rounded border-gray-300"},null,8,Nt),[[st,l(s)]])]),t("td",null,[t("span",Ht,p(d.activationCode),1)]),t("td",null,[t("span",{class:F(Z(d.status))},p(d.status),3)]),t("td",null,[t("span",Ot," ¥"+p(tt(d.price)),1)]),t("td",null,p(d.userId||"-"),1),t("td",null,[d.deviceFingerprint?(u(),m("span",qt,p(d.deviceFingerprint),1)):(u(),m("span",Et,"-"))]),t("td",null,p(P(d.activationDate)),1),t("td",null,p(P(d.expirationDate)),1),t("td",null,p(P(d.createdTime)),1),t("td",null,[t("div",Gt,[t("button",{onClick:_=>W(d.activationCode),class:"text-blue-600 hover:text-blue-800 text-sm",title:"复制激活码"}," 复制 ",8,Jt),d.status!=="已吊销"?(u(),m("button",{key:0,onClick:_=>X(d.activationCode),class:"text-red-600 hover:text-red-800 text-sm"}," 吊销 ",8,Kt)):T("",!0)])])]))),128))])])]),l(C)>1?(u(),m("div",Qt,[t("div",Wt,[t("div",Xt," 显示第 "+p((l(v)-1)*l(g)+1)+" - "+p(Math.min(l(v)*l(g),l(h)))+" 条，共 "+p(l(h))+" 条 ",1),t("div",Yt,[t("button",{onClick:e[6]||(e[6]=d=>M(l(v)-1)),disabled:l(v)<=1,class:"pagination-nav-item"}," 上一页 ",8,Zt),(u(!0),m(z,null,D(l(E),d=>(u(),m("button",{key:d,onClick:_=>M(d),class:F(["pagination-nav-item",{current:d===l(v)}])},p(d),11,te))),128)),t("button",{onClick:e[7]||(e[7]=d=>M(l(v)+1)),disabled:l(v)>=l(C),class:"pagination-nav-item"}," 下一页 ",8,ee)])])])):T("",!0),l(c)?(u(),m("div",se,[t("div",oe,[t("div",le,[e[27]||(e[27]=t("h3",{class:"text-lg font-medium text-gray-900 mb-4"},"确认吊销",-1)),t("p",ne," 确定要吊销选中的 "+p(l(s).length)+" 个激活码吗？此操作不可撤销。 ",1),t("div",ae,[e[26]||(e[26]=t("label",{class:"block text-sm font-medium text-gray-700 mb-2"},"吊销原因",-1)),w(t("textarea",{"onUpdate:modelValue":e[8]||(e[8]=d=>L(y)?y.value=d:null),class:"form-textarea",rows:"3",placeholder:"请输入吊销原因",required:""},null,512),[[$,l(y)]])]),t("div",re,[t("button",{onClick:e[9]||(e[9]=d=>c.value=!1),class:"btn-secondary"}," 取消 "),t("button",{onClick:Y,disabled:!l(y).trim()||l(S),class:"btn-danger"},p(l(S)?"吊销中...":"确认吊销"),9,de)])])])])):T("",!0)]))}}),ce={class:"flex items-center justify-between"},ue={class:"flex items-center space-x-2"},me={key:0,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},ve={key:1,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},ge={key:2,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},pe={key:3,class:"w-5 h-5",fill:"currentColor",viewBox:"0 0 20 20"},fe=["onClick"],xe=I({__name:"Toast",setup(i){const o=j(),a=b(()=>o.toasts),f=x=>{o.removeToast(x)};return(x,h)=>(u(),ot(nt,{name:"toast",tag:"div",class:"fixed top-4 right-4 z-50 space-y-2"},{default:lt(()=>[(u(!0),m(z,null,D(l(a),v=>(u(),m("div",{key:v.id,class:F(["px-6 py-4 rounded-lg shadow-lg text-white font-medium max-w-sm",{"bg-green-500":v.type==="success","bg-red-500":v.type==="error","bg-yellow-500":v.type==="warning","bg-blue-500":v.type==="info"}])},[t("div",ce,[t("div",ue,[v.type==="success"?(u(),m("svg",me,h[0]||(h[0]=[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zm3.707-9.293a1 1 0 00-1.414-1.414L9 10.586 7.707 9.293a1 1 0 00-1.414 1.414l2 2a1 1 0 001.414 0l4-4z","clip-rule":"evenodd"},null,-1)]))):v.type==="error"?(u(),m("svg",ve,h[1]||(h[1]=[t("path",{"fill-rule":"evenodd",d:"M10 18a8 8 0 100-16 8 8 0 000 16zM8.707 7.293a1 1 0 00-1.414 1.414L8.586 10l-1.293 1.293a1 1 0 101.414 1.414L10 11.414l1.293 1.293a1 1 0 001.414-1.414L11.414 10l1.293-1.293a1 1 0 00-1.414-1.414L10 8.586 8.707 7.293z","clip-rule":"evenodd"},null,-1)]))):v.type==="warning"?(u(),m("svg",ge,h[2]||(h[2]=[t("path",{"fill-rule":"evenodd",d:"M8.257 3.099c.765-1.36 2.722-1.36 3.486 0l5.58 9.92c.75 1.334-.213 2.98-1.742 2.98H4.42c-1.53 0-2.493-1.646-1.743-2.98l5.58-9.92zM11 13a1 1 0 11-2 0 1 1 0 012 0zm-1-8a1 1 0 00-1 1v3a1 1 0 002 0V6a1 1 0 00-1-1z","clip-rule":"evenodd"},null,-1)]))):(u(),m("svg",pe,h[3]||(h[3]=[t("path",{"fill-rule":"evenodd",d:"M18 10a8 8 0 11-16 0 8 8 0 0116 0zm-7-4a1 1 0 11-2 0 1 1 0 012 0zM9 9a1 1 0 000 2v3a1 1 0 001 1h1a1 1 0 100-2v-3a1 1 0 00-1-1H9z","clip-rule":"evenodd"},null,-1)]))),t("span",null,p(v.message),1)]),t("button",{onClick:C=>f(v.id),class:"ml-4 text-white hover:text-gray-200 focus:outline-none"},h[4]||(h[4]=[t("svg",{class:"w-4 h-4",fill:"currentColor",viewBox:"0 0 20 20"},[t("path",{"fill-rule":"evenodd",d:"M4.293 4.293a1 1 0 011.414 0L10 8.586l4.293-4.293a1 1 0 111.414 1.414L11.414 10l4.293 4.293a1 1 0 01-1.414 1.414L10 11.414l-4.293 4.293a1 1 0 01-1.414-1.414L8.586 10 4.293 5.707a1 1 0 010-1.414z","clip-rule":"evenodd"})],-1)]),8,fe)])],2))),128))]),_:1}))}}),he=at(xe,[["__scopeId","data-v-9e01fb2c"]]),be={class:"min-h-screen bg-gray-50 py-8"},ye={class:"max-w-7xl mx-auto px-4 sm:px-6 lg:px-8"},we={class:"grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-8"},Ce={class:"bg-white overflow-hidden shadow rounded-lg"},_e={class:"p-5"},ke={class:"flex items-center"},$e={class:"ml-5 w-0 flex-1"},Te={class:"text-lg font-medium text-gray-900"},Se={class:"bg-white overflow-hidden shadow rounded-lg"},ze={class:"p-5"},De={class:"flex items-center"},Ie={class:"ml-5 w-0 flex-1"},Me={class:"text-lg font-medium text-gray-900"},Pe={class:"bg-white overflow-hidden shadow rounded-lg"},Le={class:"p-5"},Ve={class:"flex items-center"},Fe={class:"ml-5 w-0 flex-1"},je={class:"text-lg font-medium text-gray-900"},Be={class:"bg-white overflow-hidden shadow rounded-lg"},Ue={class:"p-5"},Re={class:"flex items-center"},Ae={class:"ml-5 w-0 flex-1"},Ne={class:"text-lg font-medium text-gray-900"},He={class:"grid grid-cols-1 lg:grid-cols-3 gap-8"},Oe={class:"lg:col-span-1"},qe={class:"lg:col-span-2"},Ge=I({__name:"index",setup(i){const o=q(),a=k({totalCodes:0,activatedCodes:0,unusedCodes:0,expiredRevokedCodes:0}),f=b(()=>a.value.totalCodes),x=b(()=>a.value.activatedCodes),h=b(()=>a.value.unusedCodes),v=b(()=>a.value.expiredRevokedCodes),C=async()=>{try{console.log("开始获取统计数据");const g=await $fetch("/api/admin/stats");g.success&&g.data&&(a.value={totalCodes:g.data.totalCodes,activatedCodes:g.data.activatedCodes,unusedCodes:g.data.totalCodes-g.data.activatedCodes-g.data.expiredCodes-g.data.revokedCodes,expiredRevokedCodes:g.data.expiredCodes+g.data.revokedCodes},console.log("统计数据获取成功:",a.value))}catch(g){console.error("获取统计数据失败:",g);const n=o.codes;a.value={totalCodes:o.total,activatedCodes:n.filter(s=>s.status==="已激活").length,unusedCodes:n.filter(s=>s.status==="未使用").length,expiredRevokedCodes:n.filter(s=>s.status==="已过期"||s.status==="已吊销").length}}};return H(async()=>{console.log("Index page mounted, 开始获取数据"),await O();try{await Promise.all([C(),o.fetchCodes()]),console.log("Index page mounted, 数据获取完成")}catch(g){console.error("Index page mounted, 数据获取失败:",g)}}),(g,n)=>{const s=$t,c=ie,y=he;return u(),m("div",be,[t("div",ye,[n[8]||(n[8]=t("div",{class:"mb-8"},[t("h1",{class:"text-3xl font-bold text-gray-900"},"激活码管理系统"),t("p",{class:"mt-2 text-sm text-gray-600"},"游戏脚本激活码管理平台 - 无需登录模式")],-1)),t("div",we,[t("div",Ce,[t("div",_e,[t("div",ke,[n[1]||(n[1]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-8 h-8 bg-blue-500 rounded-md flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 15v2m-6 4h12a2 2 0 002-2v-6a2 2 0 00-2-2H6a2 2 0 00-2 2v6a2 2 0 002 2zm10-10V7a4 4 0 00-8 0v4h8z"})])])],-1)),t("div",$e,[t("dl",null,[n[0]||(n[0]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"总激活码",-1)),t("dd",Te,p(l(f)||0),1)])])])])]),t("div",Se,[t("div",ze,[t("div",De,[n[3]||(n[3]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-8 h-8 bg-green-500 rounded-md flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M9 12l2 2 4-4m6 2a9 9 0 11-18 0 9 9 0 0118 0z"})])])],-1)),t("div",Ie,[t("dl",null,[n[2]||(n[2]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"已激活",-1)),t("dd",Me,p(l(x)||0),1)])])])])]),t("div",Pe,[t("div",Le,[t("div",Ve,[n[5]||(n[5]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-8 h-8 bg-yellow-500 rounded-md flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z"})])])],-1)),t("div",Fe,[t("dl",null,[n[4]||(n[4]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"未使用",-1)),t("dd",je,p(l(h)||0),1)])])])])]),t("div",Be,[t("div",Ue,[t("div",Re,[n[7]||(n[7]=t("div",{class:"flex-shrink-0"},[t("div",{class:"w-8 h-8 bg-red-500 rounded-md flex items-center justify-center"},[t("svg",{class:"w-5 h-5 text-white",fill:"none",stroke:"currentColor",viewBox:"0 0 24 24"},[t("path",{"stroke-linecap":"round","stroke-linejoin":"round","stroke-width":"2",d:"M18.364 18.364A9 9 0 005.636 5.636m12.728 12.728L5.636 5.636m12.728 12.728L18.364 5.636M5.636 18.364l12.728-12.728"})])])],-1)),t("div",Ae,[t("dl",null,[n[6]||(n[6]=t("dt",{class:"text-sm font-medium text-gray-500 truncate"},"已过期/吊销",-1)),t("dd",Ne,p(l(v)||0),1)])])])])])]),t("div",He,[t("div",Oe,[V(s)]),t("div",qe,[V(c)])])]),V(y)])}}});export{Ge as default};
